{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "translation_page.schema.json",
  "title": "L6 번역 (Translation)",
  "description": "페이지 내 문장별 번역을 기록한다. 표점으로 분리된 문장 단위가 기본. Phase 11-2.",
  "type": "object",
  "required": ["part_id", "page_number", "translations"],
  "additionalProperties": false,
  "properties": {
    "part_id": {
      "type": "string",
      "description": "권 식별자. 예: vol1, main"
    },
    "page_number": {
      "type": "integer",
      "minimum": 1,
      "description": "페이지 번호 (1부터 시작)."
    },
    "translations": {
      "type": "array",
      "description": "번역 목록. 문장 단위.",
      "items": { "$ref": "#/$defs/Translation" }
    }
  },
  "$defs": {
    "Translation": {
      "type": "object",
      "description": "개별 번역 항목. source 범위의 원문을 target_language로 번역한 결과.",
      "required": ["id", "source", "source_text", "target_language", "translation", "translator", "status"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "번역 고유 ID. 예: tr_001"
        },
        "source": {
          "$ref": "#/$defs/SourceRef",
          "description": "원문 범위 참조. L4 텍스트의 블록 ID + 글자 범위."
        },
        "source_text": {
          "type": "string",
          "description": "원문 스냅샷. L4 변경 시 비교용."
        },
        "hyeonto_text": {
          "type": ["string", "null"],
          "description": "현토 적용된 텍스트 스냅샷. null이면 현토 미적용."
        },
        "target_language": {
          "type": "string",
          "description": "번역 대상 언어. 예: ko, en, ja"
        },
        "translation": {
          "type": "string",
          "description": "번역 텍스트."
        },
        "translator": {
          "$ref": "#/$defs/Translator",
          "description": "번역자 정보."
        },
        "status": {
          "type": "string",
          "enum": ["draft", "reviewed", "accepted"],
          "description": "번역 상태. draft → reviewed → accepted."
        },
        "reviewed_by": {
          "type": ["string", "null"],
          "description": "검토자. null이면 미검토."
        },
        "reviewed_at": {
          "type": ["string", "null"],
          "description": "검토 일시. ISO 8601."
        }
      }
    },
    "SourceRef": {
      "type": "object",
      "description": "원문 범위 참조. 블록 ID + 글자 인덱스 (0-based inclusive).",
      "required": ["block_id", "start", "end"],
      "additionalProperties": false,
      "properties": {
        "block_id": {
          "type": "string",
          "description": "대상 블록 ID."
        },
        "start": {
          "type": "integer",
          "minimum": 0,
          "description": "시작 글자 인덱스."
        },
        "end": {
          "type": "integer",
          "minimum": 0,
          "description": "끝 글자 인덱스."
        }
      }
    },
    "Translator": {
      "type": "object",
      "description": "번역자 정보. LLM 또는 사람.",
      "required": ["type"],
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string",
          "enum": ["llm", "human"],
          "description": "번역자 유형."
        },
        "model": {
          "type": ["string", "null"],
          "description": "LLM 모델명. human이면 null."
        },
        "draft_id": {
          "type": ["string", "null"],
          "description": "LLM Draft ID. human이면 null."
        }
      }
    }
  }
}
